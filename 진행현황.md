# 진행현황

## 2026-01-15 09:21
- EMOCA 추출 상태: emoca-preprocess 컨테이너에서 running 여부 확인 필요, 로그 마지막에 완료 메시지 없음.
- 얼굴 트래킹 상태: tg113 컨테이너 face_tracker 실행 중 에러 발생(nvrtc: invalid value for --gpu-architecture), track_params.pt 미생성.
- AU45 추출: OpenFace로 acting 비디오에서 au.csv 생성 완료(data/acting/au.csv).
- EMOCA 포맷: exp(50) + pose(6) 조합 상태. 앞으로는 global pose 제거, jaw 유지 방향으로 진행하기로 결정.

## 2026-01-15 09:24
- 결정 사항: 단계별 확인을 위해 mouth/head 분리 학습은 하지 않고, 얼굴 전체(입 영역 포함)를 하나로 생성/학습한다.
- 결정 사항: 헤드 모션은 카메라 트랙 고정 관점으로 접근. FLAME에서는 global pose(머리 회전) 제거, jaw(턱)는 유지한다.
- EMOCA 추출: emoca-preprocess 컨테이너에서 acting_challenge_25fps.mp4 기준 추출 진행 중(로그 상 완료 메시지 없음).
- 얼굴 트래킹: tg113 컨테이너에서 실행 중 nvrtc 오류 발생. track_params.pt 미생성 상태.
- AU45 추출: OpenFace로 acting 비디오에서 au.csv 생성 완료(data/acting/au.csv).
# GPU 사용 문제/해결 기록 (EMOCA + face_tracking)
- face_tracking GPU 실패
  - 증상: `nvrtc: error: invalid value for --gpu-architecture (-arch)`
  - 원인: 컨테이너 CUDA/torch가 RTX4090(Compute 8.9)과 아키텍처 불일치
  - 해결: `TORCH_CUDA_ARCH_LIST=8.9+PTX` 설정 후 재실행 → GPU 사용 확인

- EMOCA GPU 실행 실패
  - 증상1: `chumpy`가 `np.bool`, `np.int` 등 deprecated alias로 크래시
  - 해결1: `chumpy` 설치 후 `chumpy/__init__.py` 패치, `DecaUtils.py`의 `np.int` → `int` 치환
  - 증상2: PyTorch 2.6 체크포인트 로드 실패 (`weights_only=True` 기본값)
  - 해결2: `torch.serialization.add_safe_globals([ModelCheckpoint])` 추가
  - 증상3: `emoca.decode` 반환값 형태 mismatch
  - 해결3: decode 결과가 tuple일 경우 분기 처리
  - 최종: `TORCH_CUDA_ARCH_LIST=8.9+PTX`, `CUDA_VISIBLE_DEVICES=0` 설정으로 GPU 정상 실행
